<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ø´Ù…Ø´ Ø§Ù„Ø°ÙƒÙŠØ© âš™ï¸</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #121212; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; padding: 20px; }
        .card { background: #1e1e1e; border: 1px solid #333; border-radius: 20px; padding: 20px; max-width: 500px; margin: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { color: #ff9f43; text-align: center; }
        .btn-reset { background: #ff4757; color: white; border: none; width: 100%; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; margin-bottom: 20px; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 10px; border: 1px solid #333; background: #121212; color: white; box-sizing: border-box; }
        .btn-update { background: #ff9f43; color: black; border: none; width: 100%; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; margin-bottom: 10px; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .comm-box { background: #252525; padding: 15px; margin-top: 15px; border-radius: 15px; border-right: 4px solid #ff9f43; }
        .media-content { margin: 10px 0; }
        .media-content img { max-width: 100%; border-radius: 10px; border: 1px solid #444; }
        audio { width: 100%; height: 35px; filter: invert(1); }
        .reply-area { display: flex; gap: 5px; margin-top: 10px; }
        .btn-reply { background: #3498db; color: white; border: none; padding: 0 15px; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="card">
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„Ø© âš™ï¸</h2>
        
        <button class="btn-reset" onclick="resetEverything()">ğŸ”¥ ØªØµÙÙŠØ± Ø´Ø§Ù…Ù„ (Ù…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØ¡)</button>

        <input type="text" id="imgInp" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù‡Ù†Ø§...">
        <button class="btn-update" onclick="update('main_image', 'imgInp')">ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© ğŸ–¼ï¸</button>
        
        <input type="text" id="vidInp" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨ Ù‡Ù†Ø§...">
        <button class="btn-update" onclick="update('video_url', 'vidInp')">ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ğŸ¥</button>

        <h3 style="border-top: 1px solid #333; padding-top: 20px; margin-top: 20px;">ğŸ’¬ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§</h3>
        <div id="adminChat"></div>
    </div>

    <script>
        const conf = { databaseURL: "https://ourphotoshare-a874a-default-rtdb.firebaseio.com" };
        firebase.initializeApp(conf);
        const db = firebase.database();

        // ØªØµÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function resetEverything() {
            if(confirm("Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„ØªÙØ§Ø¹Ù„Ø§ØªØŒ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ")) {
                db.ref('/').update({ comments: null, reactions: {like:0, dislike:0}, main_image: "", video_url: "" })
                .then(() => alert("ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!"));
            }
        }

        function update(path, id) {
            const val = document.getElementById(id).value;
            if(val) db.ref(path).set(val).then(() => { alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«!"); document.getElementById(id).value = ""; });
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ¹Ø±Ø¶Ù‡Ø§ Ø­Ø³Ø¨ Ù†ÙˆØ¹Ù‡Ø§ (Ù†ØµØŒ ØµÙˆØ±Ø©ØŒ ØµÙˆØª)
        db.ref('comments').on('value', s => {
            const container = document.getElementById('adminChat');
            container.innerHTML = "";
            s.forEach(child => {
                const c = child.val();
                const id = child.key;
                let contentHTML = "";

                // ÙØ­Øµ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù…Ù†Ø¹ Ø¸Ù‡ÙˆØ± [object Object]
                if (c.type === "image") {
                    contentHTML = `<div class="media-content"><img src="${c.data}"></div>`;
                } else if (c.type === "audio") {
                    contentHTML = `<div class="media-content"><audio controls src="${c.data}"></audio></div>`;
                } else {
                    contentHTML = `<p>${c.text || c}</p>`;
                }

                container.innerHTML += `
                    <div class="comm-box">
                        ${contentHTML}
                        <div class="reply-area">
                            <input type="text" id="rep-${id}" placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§...">
                            <button class="btn-reply" onclick="reply('${id}')">Ø±Ø¯</button>
                        </div>
                        ${c.reply ? `<p style="color:#22c55e; font-size:13px; margin-top:5px;">âœ… Ø±Ø¯Ùƒ: ${c.reply}</p>` : ''}
                    </div>`;
            });
        });

        function reply(id) {
            const txt = document.getElementById('rep-'+id).value;
            if(txt) db.ref('comments/'+id).update({ reply: txt }).then(() => alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯"));
        }
    </script>
</body>
</html>
