<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø±ÙŠÙ…ÙˆØª Ø§Ù„Ø´Ø§Ù…Ù„ âš™ï¸</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; padding: 20px; text-align: center; }
        .admin-card { background: #222; border: 2px solid #ff9f43; border-radius: 20px; padding: 20px; max-width: 500px; margin: auto; }
        input, select { width: 90%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #333; color: white; }
        button { width: 95%; padding: 12px; margin: 5px 0; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-send { background: #ff9f43; color: black; }
        .btn-delete { background: #e74c3c; color: white; }
        .comm-item { background: #333; padding: 15px; margin: 15px 0; border-radius: 12px; text-align: right; border-right: 5px solid #ff9f43; }
        .reply-box { display: flex; gap: 5px; margin-top: 10px; }
        .reply-input { flex: 1; margin: 0; padding: 8px; }
        .reply-btn { width: auto; background: #3498db; padding: 8px 15px; }
    </style>
</head>
<body>

    <div class="admin-card">
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Mishmish Remote) âš™ï¸</h2>
        
        <p style="color: #888;">Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ©ØŒ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©ØŒ Ø£Ùˆ Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨</p>
        <input type="text" id="mainInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§...">
        <button class="btn-send" onclick="sendToMishmish()">ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ù…Ø´Ù…Ø´ Ø§Ù„Ø¢Ù† ğŸš€</button>
        <button class="btn-delete" onclick="resetPage()">Ù…Ø³Ø­ Ø§Ù„ØµÙØ­Ø© (ØªØµÙÙŠØ±) ğŸ§¹</button>

        <hr style="border-color:#444; margin:25px 0;">

        <h3>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø±Ø¯ÙˆØ¯ ğŸ’¬</h3>
        <div id="adminComments">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª...</div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
        const firebaseConfig = { databaseURL: "https://ourphotoshare-a874a-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…Ø³Ø§Ø± note Ù„ÙŠÙ‚Ø±Ø£Ù‡Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        function sendToMishmish() {
            const val = document.getElementById('mainInput').value;
            if(!val) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø´ÙŠØ¡ Ø£ÙˆÙ„Ø§Ù‹!");
            
            // Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ†Øµ Ù…Ø¨Ø§Ø´Ø± Ù„ØªØ¬Ù†Ø¨ Ù…Ø´ÙƒÙ„Ø© [object Object]
            db.ref('note').set(val).then(() => {
                alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«! Ø³ÙŠØ±Ø§Ù‡Ø§ Ù…Ø´Ù…Ø´ ÙÙˆØ±Ø§Ù‹ âœ…");
                document.getElementById('mainInput').value = "";
            });
        }

        // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ
        function resetPage() {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ")) {
                db.ref('note').set("").then(() => alert("ØªÙ… Ø§Ù„Ù…Ø³Ø­"));
            }
        }

        // Ø¬Ù„Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ù…Ù† Ù…Ø³Ø§Ø± comments ÙˆØ¹Ø±Ø¶Ù‡Ø§ Ù„Ù„Ø±Ø¯
        db.ref('comments').on('value', (snapshot) => {
            const container = document.getElementById('adminComments');
            container.innerHTML = "";
            
            if (!snapshot.exists()) {
                container.innerHTML = "<p style='color:#666;'>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯</p>";
                return;
            }

            snapshot.forEach((child) => {
                const id = child.key;
                const data = child.val();
                const text = typeof data === 'object' ? data.text : data;
                const currentReply = data.reply || "";

                container.innerHTML += `
                    <div class="comm-item">
                        <strong>ØªØ¹Ù„ÙŠÙ‚:</strong> <span>${text}</span>
                        ${currentReply ? `<p style="color:#ff9f43; margin:5px 0;">â†—ï¸ Ø±Ø¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${currentReply}</p>` : ''}
                        <div class="reply-box">
                            <input type="text" id="rep-${id}" class="reply-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§...">
                            <button onclick="sendReply('${id}')" class="reply-btn">Ø±Ø¯</button>
                            <button onclick="deleteComment('${id}')" style="background:#e74c3c; width:auto; padding:8px;">Ø­Ø°Ù</button>
                        </div>
                    </div>`;
            });
        });

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ ÙˆØªØ­Ø¯ÙŠØ«Ù‡ ÙÙŠ Firebase
        function sendReply(id) {
            const replyText = document.getElementById('rep-'+id).value;
            if(!replyText) return alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø¯ Ø£ÙˆÙ„Ø§Ù‹");
            
            db.ref('comments/'+id).update({ 
                reply: replyText 
            }).then(() => {
                alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ Ø¨Ù†Ø¬Ø§Ø­!");
            });
        }

        // Ø­Ø°Ù ØªØ¹Ù„ÙŠÙ‚ Ù…Ø¹ÙŠÙ†
        function deleteComment(id) {
            if(confirm("Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ØŸ")) {
                db.ref('comments/'+id).remove();
            }
        }
    </script>
</body>
</html>
